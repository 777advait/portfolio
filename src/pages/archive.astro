---
import Container from "~/components/common/container.astro";
import Layout from "~/layouts/Layout.astro";
import { Image } from "astro:assets";
import { basehub } from "~/lib/basehub";
import Link from "~/components/common/link.astro";
import LOVE from "~/assets/LOVE.webp";
import MILLENIUM from "~/assets/MILLENIUM.webp";
import TAKEOVER from "~/assets/TAKEOVER.webp";
import freedom from "~/assets/freedom.webp";
import illicit from "~/assets/illicit.webp";
import insanity from "~/assets/insanity.webp";
import intongues from "~/assets/intongues.webp";
import kendrick from "~/assets/kendrick.webp";
import redemption from "~/assets/redemption.webp";
import wanted from "~/assets/wanted.webp";
import zillionaire from "~/assets/zillionaire.webp";

const images = [
  { src: LOVE, alt: "LOVE" },
  { src: MILLENIUM, alt: "MILLENIUM" },
  { src: TAKEOVER, alt: "TAKEOVER" },
  { src: freedom, alt: "freedom" },
  { src: illicit, alt: "illicit" },
  { src: insanity, alt: "insanity" },
  { src: intongues, alt: "intongues" },
  { src: redemption, alt: "redemption" },
  { src: kendrick, alt: "kendrick" },
  { src: wanted, alt: "wanted" },
  { src: zillionaire, alt: "zillionaire" },
];

const {
  archive: {
    links: { items: links },
  },
} = await basehub.query({
  archive: {
    links: {
      __args: { orderBy: "_sys_createdAt__DESC" },
      items: { _id: true, _title: true, link: true },
    },
  },
});
---

<Layout
  content={{
    title: "archive | astroxide",
    description:
      "old graphics, experiments, and little corners of the web that stuck with me.",
  }}
>
  <main>
    <Container>
      <div class="space-y-4 md:space-y-6">
        <h1 class="font-serif text-4xl italic md:text-6xl">archive</h1>
        <div
          class="flex flex-col-reverse gap-y-12 lg:flex-row lg:justify-between lg:gap-y-0"
        >
          <div class="space-y-4 lg:max-w-[45%]">
            <h2 class="font-serif text-2xl lg:text-4xl">gfx</h2>
            <p class="text-muted-foreground text-lg">
              the artworks below are some of my creations from back in the day
              when i gave graphic designing a shot
            </p>
            <div id="archive-masonry">
              {
                images.map((img) => (
                  <Image
                    src={img.src}
                    alt={img.alt}
                    class="cursor-zoom-in"
                    data-full={img.src.src}
                  />
                ))
              }
            </div>
          </div>

          <div class="space-y-4 lg:max-w-[45%]">
            <h2 class="font-serif text-2xl lg:text-4xl">content i like</h2>
            <p class="text-muted-foreground text-lg">
              list of links from the internet that i like/appreciate (yea i
              copied this from <Link href="https://farza.com/content"
                >farza</Link
              >). i'll try to keep this updated
            </p>
            <ul class="list-inside list-decimal space-y-1.5">
              {
                links.map(({ link, _id, _title }) => (
                  <li class="text-muted-foreground text-lg">
                    <a
                      target="_blank"
                      class="underline underline-offset-4"
                      href={link}
                    >
                      {_title}
                    </a>
                  </li>
                ))
              }
            </ul>
          </div>
        </div>
      </div>
      <div
        id="previewModal"
        class="fixed inset-0 z-50 hidden items-center justify-center bg-black/80"
      >
        <img
          id="previewImg"
          src=""
          alt="full preview"
          class="max-h-[90%] max-w-[90%] rounded-lg shadow-lg"
        />
      </div>
    </Container>
  </main>

  <script>
    function setupModal() {
      const modal = document.getElementById("previewModal") as HTMLDivElement;
      const previewImg = document.getElementById(
        "previewImg"
      ) as HTMLImageElement;

      document
        .querySelectorAll<HTMLImageElement>("#archive-masonry img")
        .forEach((img) => {
          img.addEventListener("click", () => {
            const fullSrc = img.dataset.full;
            if (fullSrc) {
              previewImg.src = fullSrc;
              modal.classList.remove("hidden");
              modal.classList.add("flex");
            }
          });
        });

      modal.addEventListener("click", () => {
        modal.classList.add("hidden");
        modal.classList.remove("flex");
        previewImg.src = "";
      });
    }

    setupModal();
    document.addEventListener("astro:page-load", setupModal);
  </script>
</Layout>
